<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Malla Curricular F√≠sica - UBA</title>
  <style>
    :root {
      --aprobada: #6FCF97;
      --regular: #F2C94C;
      --pendiente: #E0E0E0;
      --bloqueada: #BDBDBD;
      --fondo: #f7f9fa;
      --texto: #333;
    }
    body.dark {
      --fondo: #1e1e1e;
      --texto: #eee;
      --aprobada: #27ae60;
      --regular: #f39c12;
      --pendiente: #555;
      --bloqueada: #333;
    }
    body {
      margin: 0;
      font-family: sans-serif;
      background: var(--fondo);
      color: var(--texto);
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #2980b9;
      color: white;
      padding: 10px 20px;
    }
    .malla {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
      padding: 20px;
    }
    .anio {
      min-width: 200px;
    }
    .anio h2 {
      text-align: center;
    }
    .materia {
      background: white;
      padding: 8px;
      margin: 5px;
      border-radius: 5px;
      cursor: pointer;
      text-align: center;
      transition: background 0.3s;
    }
    .materia.bloqueada {
      background: var(--bloqueada);
      cursor: not-allowed;
    }
    .materia.pendiente {
      background: var(--pendiente);
    }
    .materia.regular {
      background: var(--regular);
    }
    .materia.aprobada {
      background: var(--aprobada);
    }
    .notas-input {
      margin-top: 5px;
    }
    .controles {
      margin: 10px 20px;
      display: flex;
      gap: 10px;
      align-items: center;
    }
    .stats {
      font-weight: bold;
    }
  </style>
</head>
<body>
  <header>
    <h1>Malla F√≠sica UBA</h1>
    <div>
      <button onclick="toggleDarkMode()">üåì</button>
      <button onclick="resetMalla()">Reiniciar</button>
    </div>
  </header>

  <div class="controles">
    <input type="text" id="buscador" placeholder="Buscar materia...">
    <button onclick="buscarMateria()">Buscar</button>
    <span class="stats" id="estadisticas"></span>
  </div>

  <main class="malla" id="malla"></main>

  <script>
    const materias = [
      { nombre: "An√°lisis Matem√°tico I", anio: 1 },
      { nombre: "√Ålgebra I", anio: 1 },
      { nombre: "F√≠sica I", anio: 1 },
      { nombre: "An√°lisis Matem√°tico II", anio: 2 },
      { nombre: "F√≠sica II", anio: 2 },
      { nombre: "√Ålgebra II", anio: 2 },
      { nombre: "F√≠sica III", anio: 3 },
      { nombre: "Matem√°tica III", anio: 3 },
      { nombre: "Laboratorio I", anio: 3 },
      { nombre: "Matem√°tica IV", anio: 4 },
      { nombre: "F√≠sica IV", anio: 4 },
      { nombre: "Laboratorio II", anio: 4 },
      { nombre: "Laboratorio III", anio: 5 },
      { nombre: "Materia Optativa I", anio: 5, optativa: true },
      { nombre: "Materia Optativa II", anio: 5, optativa: true },
    ];

    let estado = JSON.parse(localStorage.getItem("estadoMalla")) || {};
    let modoOscuro = localStorage.getItem("modoOscuro") === "true";

    function render() {
      document.body.classList.toggle("dark", modoOscuro);
      const cont = document.getElementById("malla");
      cont.innerHTML = "";

      for (let anio = 1; anio <= 5; anio++) {
        const col = document.createElement("div");
        col.className = "anio";
        col.innerHTML = `<h2>${anio}¬∞ A√±o</h2>`;
        materias.filter(m => m.anio === anio).forEach(mat => {
          const div = document.createElement("div");
          div.className = `materia ${estado[mat.nombre]?.estado || "pendiente"}`;
          div.innerHTML = `<div>${mat.nombre}</div>`;
          if (mat.optativa) div.contentEditable = true;
          div.onclick = () => cambiarEstado(mat.nombre);

          if (estado[mat.nombre]?.estado === "aprobada") {
            div.innerHTML += `<div class='notas-input'>Nota: ${estado[mat.nombre].nota}</div>`;
          }

          col.appendChild(div);
        });
        cont.appendChild(col);
      }

      actualizarEstadisticas();
    }

    function cambiarEstado(nombre) {
      if (!estado[nombre]) estado[nombre] = { estado: "pendiente" };
      const actual = estado[nombre].estado;
      if (actual === "pendiente") {
        estado[nombre].estado = "regular";
        alert("Bien hecho, materia regularizada.");
      } else if (actual === "regular") {
        const nota = prompt("Ingrese nota (1-10):");
        const n = parseInt(nota);
        if (!isNaN(n) && n >= 1 && n <= 10) {
          estado[nombre].estado = "aprobada";
          estado[nombre].nota = n;
          alert("¬°Felicitaciones, materia aprobada!");
        } else {
          alert("Nota inv√°lida.");
        }
      } else {
        estado[nombre] = { estado: "pendiente" };
      }
      guardar();
    }

    function guardar() {
      localStorage.setItem("estadoMalla", JSON.stringify(estado));
      render();
    }

    function toggleDarkMode() {
      modoOscuro = !modoOscuro;
      localStorage.setItem("modoOscuro", modoOscuro);
      render();
    }

    function resetMalla() {
      if (confirm("¬øSeguro que quer√©s reiniciar todo?")) {
        if (confirm("¬øEst√°s realmente seguro?")) {
          localStorage.removeItem("estadoMalla");
          estado = {};
          render();
        }
      }
    }

    function buscarMateria() {
      const texto = document.getElementById("buscador").value.toLowerCase();
      const divs = document.querySelectorAll(".materia");
      divs.forEach(div => {
        const nombre = div.innerText.toLowerCase();
        div.style.border = nombre.includes(texto) ? "2px solid red" : "none";
      });
    }

    function actualizarEstadisticas() {
      let aprob = 0, reg = 0, pend = 0;
      materias.forEach(m => {
        const est = estado[m.nombre]?.estado || "pendiente";
        if (est === "aprobada") aprob++;
        else if (est === "regular") reg++;
        else pend++;
      });
      document.getElementById("estadisticas").textContent = `Aprobadas: ${aprob} | Regulares: ${reg} | Pendientes: ${pend}`;
    }

    render();
  </script>
</body>
</html>
